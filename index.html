<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Audio Visualizer based on Three.js</title>
  <link href="https://fonts.googleapis.com/css?family=Saira" rel="stylesheet">
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <div id="header">
    <h1>MULTIMOD | MrGato y sus putas 2</h1>
  </div>
  <div id="right">
    <h2>DISCORD OFICIAL:</h2>
    <h3><a href="https://discord.gg/49BxqscV" target="_blank">https://discord.gg/49BxqscV</a></h3>
  </div>
  <div id="content">
    <label for="thefile" class="file" style="display: none;"> Choose an audio file
      <input type="file" id="thefile" accept="audio/*" style="display: none;" />
    </label>
    <select id="preloaded-audio" style="display: none;">
      <option value="">Select a song</option>
      <option value="audio/donki.mp3">Song 1</option>
      <option value="audio/kaskade.mp3">Song 2</option>
      <option value="audio/twofriends.mp3">Song 3</option>
    </select>
    <audio id="audio" controls style="display: none;"></audio>
    <div id="out"></div>
  </div>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/three.js/84/three.min.js'></script>
  <script src='https://cdn.rawgit.com/mrdoob/three.js/master/examples/js/controls/OrbitControls.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.3/dat.gui.min.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/simplex-noise/2.3.0/simplex-noise.min.js'></script>
  <script src="./script.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
        const file = document.getElementById('thefile');
        const audio = document.getElementById('audio');
        const preloadedAudio = document.getElementById('preloaded-audio');
        const fileLabel = document.querySelector("label.file");

        function getRandomSong() {
            const options = Array.from(preloadedAudio.options);
            const validOptions = options.filter(option => option.value !== "");
            const randomIndex = Math.floor(Math.random() * validOptions.length);
            return validOptions[randomIndex].value;
        }

        function playAudio(src) {
            audio.src = src;
            audio.volume = 0.05;  // Ajusta el volumen al 10%
            audio.load();
            audio.play().then(() => {
                play();
            }).catch(error => {
                console.error('Error playing audio:', error);
            });
        }

        // Reproduce una canción aleatoria al cargar la página
        window.addEventListener('load', () => {
            const randomSong = getRandomSong();
            if (randomSong) {
                playAudio(randomSong);
            }
        });

        file.onchange = function() {
            const files = this.files;
            if (files.length > 0) {
                fileLabel.classList.add('normal');
                audio.classList.add('active');
                playAudio(URL.createObjectURL(files[0]));
            }
        };

        preloadedAudio.onchange = function() {
            const selectedValue = this.value;
            if (selectedValue) {
                playAudio(selectedValue);
            }
        };
    });
  </script>
</body>
</html>

